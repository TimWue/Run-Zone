(this["webpackJsonprun-zone-ts"]=this["webpackJsonprun-zone-ts"]||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var r,c=n(0),o=n.n(c),s=n(18),a=n.n(s),i=(n(32),n(33),n(13)),u=n(3),j=n(6),l=n(1),d=Object(c.createContext)({runnerPosition:void 0,runnerSpeed:null,runner:{runnerName:"",runnerRunIds:[]},runs:[],setRunner:function(e){},setRuns:function(e){},addRun:function(e){},setRunnerPosition:function(e){}}),b=function(e){var t=e.children,n=Object(c.useState)([]),r=Object(u.a)(n,2),o=r[0],s=r[1],a=Object(c.useState)(),b=Object(u.a)(a,2),O=b[0],f=b[1],x=Object(c.useState)(null),p=Object(u.a)(x,2),h=p[0],g=p[1],v=Object(c.useState)({runnerName:"",runnerRunIds:[]}),m=Object(u.a)(v,2),R=m[0],S=m[1],w={enableHighAccuracy:!0},k=function(e){console.warn("ERROR(".concat(e.code,"): ").concat(e.message))},y=function(e){f(new j.LatLng(e.coords.latitude,e.coords.longitude)),e.coords.speed&&g((3.6*e.coords.speed).toFixed(1))};return Object(c.useEffect)((function(){navigator.geolocation.watchPosition(y,k,w)}),[]),Object(l.jsx)(d.Provider,{value:{runner:R,setRunner:S,runs:o,setRuns:s,runnerPosition:O,setRunnerPosition:f,addRun:function(e){s((function(t){return[].concat(Object(i.a)(t),[e])}))},runnerSpeed:h},children:t})},O=n(9),f=n.n(O),x=n(21),p=[{runnerName:"Tim",runnerRunIds:[]},{runnerName:"Leonie",runnerRunIds:[3]}],h=function(){var e=localStorage.getItem("runs"),t=e?JSON.parse(e):void 0;return{getRun:function(e){var n=void 0;for(var r in t)t[r].runId===e&&(n=t[r]);return Promise.resolve(n)},saveRuns:function(e){localStorage.setItem("runs",JSON.stringify(e))},getAllRuns:function(){return t}}},g=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1],s={getTracks:function(e){var t=[];for(var n in p)p[n].runnerName===e&&(t=p[n].runnerRunIds);return Promise.resolve(t)},getRunner:function(e){return Promise.resolve(p.find((function(t){return t.runnerName===e})))}},a=function(e,t){return{getRuns:function(n){return Object(x.a)(f.a.mark((function r(){var c,o;return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=[],r.next=3,e.getTracks(n);case 3:return o=r.sent,r.next=6,Promise.all(o.map(function(){var e=Object(x.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRun(n);case 2:(r=e.sent)&&c.push(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return r.abrupt("return",c);case 7:case"end":return r.stop()}}),r)})))()},getRunner:function(t){return Object(x.a)(f.a.mark((function n(){var r;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getRunner(t);case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}}),n)})))()}}}(s,h()),i=Object(c.useContext)(d).setRunner;return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{type:"text",onChange:function(e){o(e.target.value)},value:r,placeholder:"Enter your Name:"}),Object(l.jsx)("button",{onClick:function(){console.log("Login "+r),a.getRunner(r).then((function(e){e&&i(e)}))},children:"Login"})]})},v=n(24),m=n(41),R=n(43),S=n(38),w=n(23),k=function(){return{track2Polygon:function(e){return e.map((function(e){return[e.latitude,e.longitude]}))},calcArea:function(e){var t=e.map((function(e){return[e.latitude,e.longitude]})),n=Object(w.polygon)([t]);return Object(w.area)(n)/1e6}}},y=function(e){var t=e.runs,n=k();return Object(l.jsx)(l.Fragment,{children:t.map((function(e,t){return Object(l.jsx)(S.a,{positions:n.track2Polygon(e.track.trackPoints)})}))})},C=n(39),P=n(40),N=function(){var e=Object(c.useContext)(d).runnerPosition,t=Object(C.a)();return Object(c.useEffect)((function(){e&&t.setView(e)}),[e]),Object(l.jsx)(l.Fragment,{children:e&&Object(l.jsx)(P.a,{position:e})})},T=function(e){var t=e.setShowRuns;return Object(l.jsx)("div",{className:"leaflet-top leaflet-right",children:Object(l.jsx)("div",{className:"leaflet-control",children:Object(l.jsx)("button",{onClick:function(){return t((function(e){return!e}))},children:"Show Runs"})})})},F=function(e){Object(v.a)(e);var t=Object(c.useContext)(d).runs,n=Object(c.useState)(!1),r=Object(u.a)(n,2),o=r[0],s=r[1];return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)(m.a,{className:"basicMap",center:[0,0],zoom:20,scrollWheelZoom:!1,style:{width:"100%",height:"400px",borderRadius:"8px"},children:[Object(l.jsx)(R.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),o&&Object(l.jsx)(y,{runs:t}),Object(l.jsx)(N,{}),Object(l.jsx)(T,{setShowRuns:s})]})})},I=function(e){return Object(l.jsx)(F,{})},E=Object(c.createContext)({}),L=function(e){var t=e.children,n=Object(c.useState)(),r=Object(u.a)(n,2),o=r[0],s=r[1],a=Object(c.useState)([]),j=Object(u.a)(a,2),d=j[0],b=j[1],O=Object(c.useState)(),f=Object(u.a)(O,2),x=f[0],p=f[1],h=Object(c.useState)(!1),g=Object(u.a)(h,2),v=g[0],m=g[1];return Object(l.jsx)(E.Provider,{value:{startTime:o,isRunning:v,setIsRunning:m,run:x,startRun:function(){console.log("Start Run"),s(Date.now()),m(!0)},stopRun:function(){console.log("Stop Run"),p({track:{trackPoints:d},startTime:o||Date.now(),endTime:Date.now()}),m(!1)},addTrackPoint:function(e){console.log("Add TrackPoint: ",e),b((function(t){return[].concat(Object(i.a)(t),[e])}))},resetRun:function(){p(void 0),s(void 0),b([])}},children:t})},W=n(42),z=n(44),D=function(){var e=Object(c.useContext)(d).runnerPosition,t=Object(c.useContext)(E),n=t.addTrackPoint,r=t.startRun,o=t.stopRun,s=t.run,a=t.resetRun,u=t.isRunning,j=Object(c.useContext)(d),b=j.addRun,O=j.runs,f=h();Object(c.useEffect)((function(){u&&x()}),[e]);var x=function(){e&&n({latitude:e.lat,longitude:e.lng,time:Date.now()})};return Object(l.jsxs)(W.a,{size:"lg",children:[Object(l.jsx)(z.a,{onClick:function(){r()},disabled:u,variant:"dark",children:"Start"}),Object(l.jsx)(z.a,{onClick:function(){o()},disabled:!u,variant:"dark",children:"Stop"}),Object(l.jsx)(z.a,{onClick:function(){console.log("Save run"),f.saveRuns([].concat(Object(i.a)(O),[s])),b(s)},disabled:u,variant:"dark",children:"Save"}),Object(l.jsx)(z.a,{onClick:function(){console.log("Reset run"),a()},disabled:u,variant:"dark",children:"Reset"})]})},A=function(e){var t=e.property,n=e.value;return Object(l.jsxs)("div",{style:{width:"20%",minWidth:"120px",backgroundColor:"#555",borderRadius:"10px",padding:"10px",margin:"10px 5px 10px 5px"},children:[Object(l.jsx)("div",{style:{fontFamily:"Open Sans Condensed, sans-serif",fontSize:"28px",fontWeight:"bold",textTransform:"uppercase",color:"#eee"},children:t}),Object(l.jsx)("div",{style:{fontFamily:"Open Sans Condensed, sans-serif",fontSize:"24px",fontWeight:"bold",textTransform:"uppercase",color:"#eee"},children:n})]})},M=function(e){var t=Object(c.useContext)(d).runnerSpeed,n=Object(c.useContext)(E),r=n.startTime,o=n.isRunning,s=Object(c.useState)(0),a=Object(u.a)(s,2),i=a[0],j=a[1],b=Object(c.useState)(),O=Object(u.a)(b,2),f=O[0],x=O[1];return Object(c.useEffect)((function(){if(o){var e=setInterval((function(){console.log("RunTime: ",i),console.log("StartTime: ",r),console.log("Now: ",Date.now()),r&&j(Date.now()-r)}),1e3);x(e)}else f&&clearInterval(f)}),[o]),Object(l.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"50%",padding:"5px",flexWrap:"wrap"},children:[Object(l.jsx)(A,{property:"Speed",value:t?t+" [km/h]":"--"}),Object(l.jsx)(A,{property:"Time",value:new Date(i).toISOString().substr(11,8)})]})},J=function(){return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(I,{}),Object(l.jsx)(D,{}),Object(l.jsx)(M,{})]})},U=function(e){var t=e.center,n=Object(C.a)();return Object(c.useEffect)((function(){n.setView(t)}),[t]),Object(l.jsx)(l.Fragment,{})},V=function(){var e=Object(c.useContext)(d).runs,t=Object(c.useState)(),n=Object(u.a)(t,2),r=n[0],o=n[1],s=Object(c.useState)(0),a=Object(u.a)(s,2),i=a[0],b=a[1],O=Object(c.useState)(new j.LatLng(0,0)),f=Object(u.a)(O,2),x=f[0],p=f[1],h=k();Object(c.useEffect)((function(){o(e[i]);var t=e[i].track.trackPoints[0];p(new j.LatLng(t.latitude,t.longitude))}),[i]);var g=function(t){b((function(n){var r;return r=(r=n+t>=e.length-1?e.length-1:n+t)<0?0:r}))};return Object(l.jsxs)(l.Fragment,{children:[r&&Object(l.jsx)("div",{style:{color:"white"},children:new Date(r.startTime).toUTCString()}),Object(l.jsxs)(m.a,{className:"basicMap",center:[0,0],zoom:20,scrollWheelZoom:!1,style:{width:"100%",height:"400px",borderRadius:"8px"},children:[Object(l.jsx)(R.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),Object(l.jsx)(U,{center:x}),r&&Object(l.jsx)(S.a,{positions:h.track2Polygon(r.track.trackPoints)})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)(z.a,{style:{width:"50%"},variant:"dark",disabled:i<=0,onClick:function(){return g(-1)},children:"Zur\xfcck"}),Object(l.jsx)(z.a,{style:{width:"50%"},variant:"dark",disabled:i>=e.length-1,onClick:function(){return g(1)},children:"Vor"})]})]})};!function(e){e.ROOT="/",e.NEW="new",e.RUNS="runs"}(r||(r={}));var Z=n(2),B=n(14),H=function(e){var t=e.to,n=e.value;return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)(B.b,{to:t,style:{color:"white",fontSize:"26px",margin:"20px"},children:n})})},q=function(){return Object(l.jsxs)("div",{children:[Object(l.jsx)(H,{to:r.NEW,value:"Neu"}),Object(l.jsx)(H,{to:r.RUNS,value:"L\xe4ufe"})]})},G=function(e){var t=Object(c.useContext)(d).runner;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("h2",{style:{color:"#eee",fontFamily:"Open Sans Condensed, sans-serif",fontSize:"48px",fontWeight:"bold",lineHeight:"48px",padding:"0 5px",textAlign:"center",textTransform:"uppercase",minWidth:"200px"},children:["Moin ",t.runnerName]}),Object(l.jsx)(q,{})]})};var K=function(){var e=Object(c.useContext)(d),t=e.runner,n=e.setRuns,o=h();return Object(c.useEffect)((function(){n(o.getAllRuns())}),[t]),Object(l.jsx)(l.Fragment,{children:""===(null===t||void 0===t?void 0:t.runnerName)?Object(l.jsx)(g,{}):Object(l.jsxs)("div",{style:{width:"80%",height:"100%",margin:"auto"},children:[Object(l.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:" 1% 0 1% 0",flexWrap:"wrap",margin:"20px 0 20px 0"},children:Object(l.jsx)(G,{})}),Object(l.jsxs)(Z.c,{children:[Object(l.jsx)(Z.a,{path:r.NEW,element:Object(l.jsx)(J,{})}),Object(l.jsx)(Z.a,{path:r.RUNS,element:Object(l.jsx)(V,{})})]})]})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,45)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),o(e),s(e)}))};a.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(b,{children:Object(l.jsx)(L,{children:Object(l.jsx)(B.a,{children:Object(l.jsx)(K,{})})})})}),document.getElementById("root")),Q()}},[[37,1,2]]]);
//# sourceMappingURL=main.756953a6.chunk.js.map