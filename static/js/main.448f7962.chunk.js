(this["webpackJsonprun-zone-ts"]=this["webpackJsonprun-zone-ts"]||[]).push([[0],{23:function(n,e,t){},24:function(n,e,t){},28:function(n,e,t){"use strict";t.r(e);var r=t(0),c=t.n(r),u=t(12),o=t.n(u),s=(t(23),t(24),t(7)),a=t.n(s),i=t(14),j=function(n,e){return{getRuns:function(t){return Object(i.a)(a.a.mark((function r(){var c,u;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=[],r.next=3,n.getTracks(t);case 3:return u=r.sent,r.next=6,Promise.all(u.map(function(){var n=Object(i.a)(a.a.mark((function n(t){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getRun(t);case 2:(r=n.sent)&&c.push(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()));case 6:return r.abrupt("return",c);case 7:case"end":return r.stop()}}),r)})))()},getRunner:function(e){return Object(i.a)(a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getRunner(e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))()}}},l=t(2),b=t(32),d=t(33),O=t(9),f=t(4),g=t(1),x=Object(r.createContext)({runnerPosition:void 0,runnerSpeed:null,runner:{runnerName:"",runnerRunIds:[]},runs:[],setRunner:function(n){},setRuns:function(n){},addRun:function(n){},setRunnerPosition:function(n){}}),h=function(n){var e=n.children,t=Object(r.useState)([]),c=Object(l.a)(t,2),u=c[0],o=c[1],s=Object(r.useState)(),a=Object(l.a)(s,2),i=a[0],j=a[1],b=Object(r.useState)(null),d=Object(l.a)(b,2),h=d[0],v=d[1],R=Object(r.useState)({runnerName:"",runnerRunIds:[]}),p=Object(l.a)(R,2),m=p[0],S=p[1],C={enableHighAccuracy:!0},w=function(n){console.warn("ERROR(".concat(n.code,"): ").concat(n.message))},k=function(n){j(new f.LatLng(n.coords.latitude,n.coords.longitude)),v(n.coords.speed)};return Object(r.useEffect)((function(){navigator.geolocation.watchPosition(k,w,C)}),[]),Object(g.jsx)(x.Provider,{value:{runner:m,setRunner:S,runs:u,setRuns:o,runnerPosition:i,setRunnerPosition:j,addRun:function(n){o((function(e){return[].concat(Object(O.a)(e),[n])}))},runnerSpeed:h},children:e})},v=t(29),R=t(16),p=function(n){var e=n.runs,t={track2Polygon:function(n){return n.map((function(n){return[n.latitude,n.longitude]}))},calcArea:function(n){var e=n.map((function(n){return[n.latitude,n.longitude]})),t=Object(R.polygon)([e]);return Object(R.area)(t)/1e6}};return Object(g.jsx)(g.Fragment,{children:e.map((function(n,e){return Object(g.jsx)(v.a,{positions:t.track2Polygon(n.track.trackPoints)})}))})},m=t(30),S=t(31),C=function(){var n=Object(r.useContext)(x).runnerPosition,e=Object(m.a)();return Object(r.useEffect)((function(){n&&e.setView(n)}),[n]),Object(g.jsx)(g.Fragment,{children:n&&Object(g.jsx)(S.a,{position:n})})},w=function(n){var e=n.setShowRuns;return Object(g.jsx)("div",{className:"leaflet-top leaflet-right",children:Object(g.jsx)("div",{className:"leaflet-control",children:Object(g.jsx)("button",{onClick:function(){return e((function(n){return!n}))},children:"Show Runs"})})})},k=function(n){var e=n.runnersRunController,t=Object(r.useContext)(x),c=t.runner,u=t.runs,o=t.setRuns,s=Object(r.useState)(!1),a=Object(l.a)(s,2),i=a[0],j=a[1];return Object(r.useEffect)((function(){e.getRunsOfRunner(c.runnerName).then((function(n){o(n)}))}),[c]),Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)(b.a,{className:"basicMap",center:[0,0],zoom:20,scrollWheelZoom:!1,style:{width:"100%",height:"400px",borderRadius:"8px"},children:[Object(g.jsx)(d.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),i&&Object(g.jsx)(p,{runs:u}),Object(g.jsx)(C,{}),Object(g.jsx)(w,{setShowRuns:j})]})})},P=[{runnerName:"Tim",runnerRunIds:[]},{runnerName:"Leonie",runnerRunIds:[3]}],N=function(){return{getTracks:function(n){var e=[];for(var t in P)P[t].runnerName===n&&(e=P[t].runnerRunIds);return Promise.resolve(e)},getRunner:function(n){return Promise.resolve(P.find((function(e){return e.runnerName===n})))}}},T=function(){var n=localStorage.getItem("runs"),e=n?JSON.parse(n):void 0;return{getRun:function(n){var t=void 0;for(var r in e)e[r].runId===n&&(t=e[r]);return Promise.resolve(t)},saveRuns:function(n){localStorage.setItem("runs",JSON.stringify(n))}}},I=function(n){var e=N(),t=T(),c=function(n){return{getRunsOfRunner:Object(r.useCallback)((function(e){return n.getRuns(e)}),[n])}}(j(e,t));return Object(g.jsx)(k,{runnersRunController:c})},y=Object(r.createContext)({}),F=function(n){var e=n.children,t=Object(r.useState)(),c=Object(l.a)(t,2),u=c[0],o=c[1],s=Object(r.useState)([]),a=Object(l.a)(s,2),i=a[0],j=a[1],b=Object(r.useState)(),d=Object(l.a)(b,2),f=d[0],x=d[1],h=Object(r.useState)(!1),v=Object(l.a)(h,2),R=v[0],p=v[1];return Object(g.jsx)(y.Provider,{value:{startTime:u,isRunning:R,setIsRunning:p,run:f,startRun:function(){console.log("Start Run"),o(Date.now()),p(!0)},stopRun:function(){console.log("Stop Run"),x({track:{trackPoints:i},startTime:u||Date.now(),endTime:Date.now()}),p(!1)},addTrackPoint:function(n){console.log("Add TrackPoint: ",n),j((function(e){return[].concat(Object(O.a)(e),[n])}))},resetRun:function(){x(void 0),o(void 0),j([])}},children:e})},D=function(n){var e=Object(r.useContext)(x).runnerSpeed,t=Object(r.useContext)(y),c=t.startTime,u=t.isRunning,o=Object(r.useState)(0),s=Object(l.a)(o,2),a=s[0],i=s[1],j=Object(r.useState)(),b=Object(l.a)(j,2),d=b[0],O=b[1];return Object(r.useEffect)((function(){if(u){var n=setInterval((function(){console.log("RunTime: ",a),console.log("StartTime: ",c),console.log("Now: ",Date.now()),c&&i(Date.now()-c)}),1e3);O(n)}else d&&clearInterval(d)}),[u]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h3",{children:["Speed: ",e]}),Object(g.jsxs)("h3",{children:["Time: ",new Date(a).toISOString().substr(11,8)]})]})},E=function(n){var e=Object(r.useState)(""),t=Object(l.a)(e,2),c=t[0],u=t[1],o=N(),s=T(),a=j(o,s),i=Object(r.useContext)(x).setRunner;return Object(g.jsxs)("div",{children:[Object(g.jsx)("input",{type:"text",onChange:function(n){u(n.target.value)},value:c,placeholder:"Enter your Name:"}),Object(g.jsx)("button",{onClick:function(){console.log("Login "+c),a.getRunner(c).then((function(n){n&&i(n)}))},children:"Login"})]})},L=function(){var n=Object(r.useContext)(x).runnerPosition,e=Object(r.useContext)(y),t=e.addTrackPoint,c=e.startRun,u=e.stopRun,o=e.run,s=e.resetRun,a=e.isRunning,i=Object(r.useContext)(x),j=i.addRun,l=i.runs,b=T();Object(r.useEffect)((function(){a&&d()}),[n]);var d=function(){n&&t({latitude:n.lat,longitude:n.lng,time:Date.now()})};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("button",{onClick:function(){c()},disabled:a,children:"Start"}),Object(g.jsx)("button",{onClick:function(){u()},disabled:!a,children:"Stop"}),Object(g.jsx)("button",{onClick:function(){console.log("Save run"),b.saveRuns([].concat(Object(O.a)(l),[o])),j(o)},disabled:a,children:"Save"}),Object(g.jsx)("button",{onClick:function(){console.log("Reset run"),s()},disabled:a,children:"Reset"})]})},z=function(n){var e=Object(r.useContext)(x).runner;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{children:Object(g.jsxs)("h3",{children:["Moin ",e.runnerName]})}),Object(g.jsx)("div",{children:Object(g.jsx)(L,{})})]})};var J=function(){var n=Object(r.useContext)(x).runner;return Object(g.jsx)(g.Fragment,{children:""===(null===n||void 0===n?void 0:n.runnerName)?Object(g.jsx)(E,{}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(z,{}),Object(g.jsx)(I,{}),Object(g.jsx)(D,{})]})})},M=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,34)).then((function(e){var t=e.getCLS,r=e.getFID,c=e.getFCP,u=e.getLCP,o=e.getTTFB;t(n),r(n),c(n),u(n),o(n)}))};o.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(h,{children:Object(g.jsx)(F,{children:Object(g.jsx)(J,{})})})}),document.getElementById("root")),M()}},[[28,1,2]]]);
//# sourceMappingURL=main.448f7962.chunk.js.map