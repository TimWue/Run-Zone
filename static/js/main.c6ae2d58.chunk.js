(this["webpackJsonprun-zone-ts"]=this["webpackJsonprun-zone-ts"]||[]).push([[0],{30:function(e,n,t){},31:function(e,n,t){},35:function(e,n,t){"use strict";t.r(n);var r,c=t(0),o=t.n(c),u=t(17),s=t.n(u),i=(t(30),t(31),t(14)),a=t(3),l=t(8),j=t(1),d=Object(c.createContext)({runnerPosition:void 0,runnerSpeed:null,runner:{runnerName:"",runnerRunIds:[]},runs:[],setRunner:function(e){},setRuns:function(e){},addRun:function(e){},setRunnerPosition:function(e){}}),b=function(e){var n=e.children,t=Object(c.useState)([]),r=Object(a.a)(t,2),o=r[0],u=r[1],s=Object(c.useState)(),b=Object(a.a)(s,2),f=b[0],O=b[1],x=Object(c.useState)(null),p=Object(a.a)(x,2),g=p[0],h=p[1],v=Object(c.useState)({runnerName:"",runnerRunIds:[]}),m=Object(a.a)(v,2),R=m[0],S=m[1],w={enableHighAccuracy:!0},k=function(e){console.warn("ERROR(".concat(e.code,"): ").concat(e.message))},C=function(e){O(new l.LatLng(e.coords.latitude,e.coords.longitude)),e.coords.speed&&h((3.6*e.coords.speed).toFixed(1))};return Object(c.useEffect)((function(){navigator.geolocation.watchPosition(C,k,w)}),[]),Object(j.jsx)(d.Provider,{value:{runner:R,setRunner:S,runs:o,setRuns:u,runnerPosition:f,setRunnerPosition:O,addRun:function(e){u((function(n){return[].concat(Object(i.a)(n),[e])}))},runnerSpeed:g},children:n})},f=t(9),O=t.n(f),x=t(20),p=function(e,n){return{getRuns:function(t){return Object(x.a)(O.a.mark((function r(){var c,o;return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=[],r.next=3,e.getTracks(t);case 3:return o=r.sent,r.next=6,Promise.all(o.map(function(){var e=Object(x.a)(O.a.mark((function e(t){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getRun(t);case 2:(r=e.sent)&&c.push(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 6:return r.abrupt("return",c);case 7:case"end":return r.stop()}}),r)})))()},getRunner:function(n){return Object(x.a)(O.a.mark((function t(){var r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRunner(n);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))()}}},g=[{runnerName:"Tim",runnerRunIds:[]},{runnerName:"Leonie",runnerRunIds:[3]}],h=function(){return{getTracks:function(e){var n=[];for(var t in g)g[t].runnerName===e&&(n=g[t].runnerRunIds);return Promise.resolve(n)},getRunner:function(e){return Promise.resolve(g.find((function(n){return n.runnerName===e})))}}},v=function(){var e=localStorage.getItem("runs"),n=e?JSON.parse(e):void 0;return{getRun:function(e){var t=void 0;for(var r in n)n[r].runId===e&&(t=n[r]);return Promise.resolve(t)},saveRuns:function(e){localStorage.setItem("runs",JSON.stringify(e))}}},m=function(e){var n=Object(c.useState)(""),t=Object(a.a)(n,2),r=t[0],o=t[1],u=h(),s=v(),i=p(u,s),l=Object(c.useContext)(d).setRunner;return Object(j.jsxs)("div",{children:[Object(j.jsx)("input",{type:"text",onChange:function(e){o(e.target.value)},value:r,placeholder:"Enter your Name:"}),Object(j.jsx)("button",{onClick:function(){console.log("Login "+r),i.getRunner(r).then((function(e){e&&l(e)}))},children:"Login"})]})},R=t(40),S=t(43),w=t(37),k=t(22),C=function(e){var n=e.runs,t={track2Polygon:function(e){return e.map((function(e){return[e.latitude,e.longitude]}))},calcArea:function(e){var n=e.map((function(e){return[e.latitude,e.longitude]})),t=Object(k.polygon)([n]);return Object(k.area)(t)/1e6}};return Object(j.jsx)(j.Fragment,{children:n.map((function(e,n){return Object(j.jsx)(w.a,{positions:t.track2Polygon(e.track.trackPoints)})}))})},y=t(38),N=t(39),P=function(){var e=Object(c.useContext)(d).runnerPosition,n=Object(y.a)();return Object(c.useEffect)((function(){e&&n.setView(e)}),[e]),Object(j.jsx)(j.Fragment,{children:e&&Object(j.jsx)(N.a,{position:e})})},T=function(e){var n=e.setShowRuns;return Object(j.jsx)("div",{className:"leaflet-top leaflet-right",children:Object(j.jsx)("div",{className:"leaflet-control",children:Object(j.jsx)("button",{onClick:function(){return n((function(e){return!e}))},children:"Show Runs"})})})},F=function(e){var n=e.runnersRunController,t=Object(c.useContext)(d),r=t.runner,o=t.runs,u=t.setRuns,s=Object(c.useState)(!1),i=Object(a.a)(s,2),l=i[0],b=i[1];return Object(c.useEffect)((function(){n.getRunsOfRunner(r.runnerName).then((function(e){u(e)}))}),[r]),Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)(R.a,{className:"basicMap",center:[0,0],zoom:20,scrollWheelZoom:!1,style:{width:"100%",height:"400px",borderRadius:"8px"},children:[Object(j.jsx)(S.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),l&&Object(j.jsx)(C,{runs:o}),Object(j.jsx)(P,{}),Object(j.jsx)(T,{setShowRuns:b})]})})},I=function(e){var n=h(),t=v(),r=function(e){return{getRunsOfRunner:Object(c.useCallback)((function(n){return e.getRuns(n)}),[e])}}(p(n,t));return Object(j.jsx)(F,{runnersRunController:r})},W=Object(c.createContext)({}),E=function(e){var n=e.children,t=Object(c.useState)(),r=Object(a.a)(t,2),o=r[0],u=r[1],s=Object(c.useState)([]),l=Object(a.a)(s,2),d=l[0],b=l[1],f=Object(c.useState)(),O=Object(a.a)(f,2),x=O[0],p=O[1],g=Object(c.useState)(!1),h=Object(a.a)(g,2),v=h[0],m=h[1];return Object(j.jsx)(W.Provider,{value:{startTime:o,isRunning:v,setIsRunning:m,run:x,startRun:function(){console.log("Start Run"),u(Date.now()),m(!0)},stopRun:function(){console.log("Stop Run"),p({track:{trackPoints:d},startTime:o||Date.now(),endTime:Date.now()}),m(!1)},addTrackPoint:function(e){console.log("Add TrackPoint: ",e),b((function(n){return[].concat(Object(i.a)(n),[e])}))},resetRun:function(){p(void 0),u(void 0),b([])}},children:n})},D=t(41),z=t(42),L=function(){var e=Object(c.useContext)(d).runnerPosition,n=Object(c.useContext)(W),t=n.addTrackPoint,r=n.startRun,o=n.stopRun,u=n.run,s=n.resetRun,a=n.isRunning,l=Object(c.useContext)(d),b=l.addRun,f=l.runs,O=v();Object(c.useEffect)((function(){a&&x()}),[e]);var x=function(){e&&t({latitude:e.lat,longitude:e.lng,time:Date.now()})};return Object(j.jsxs)(D.a,{size:"lg",children:[Object(j.jsx)(z.a,{onClick:function(){r()},disabled:a,variant:"dark",children:"Start"}),Object(j.jsx)(z.a,{onClick:function(){o()},disabled:!a,variant:"dark",children:"Stop"}),Object(j.jsx)(z.a,{onClick:function(){console.log("Save run"),O.saveRuns([].concat(Object(i.a)(f),[u])),b(u)},disabled:a,variant:"dark",children:"Save"}),Object(j.jsx)(z.a,{onClick:function(){console.log("Reset run"),s()},disabled:a,variant:"dark",children:"Reset"})]})},A=function(e){var n=e.property,t=e.value;return Object(j.jsxs)("div",{style:{width:"20%",minWidth:"120px",backgroundColor:"#555",borderRadius:"10px",padding:"10px",margin:"10px 5px 10px 5px"},children:[Object(j.jsx)("div",{style:{fontFamily:"Open Sans Condensed, sans-serif",fontSize:"28px",fontWeight:"bold",textTransform:"uppercase",color:"#eee"},children:n}),Object(j.jsx)("div",{style:{fontFamily:"Open Sans Condensed, sans-serif",fontSize:"24px",fontWeight:"bold",textTransform:"uppercase",color:"#eee"},children:t})]})},J=function(e){var n=Object(c.useContext)(d).runnerSpeed,t=Object(c.useContext)(W),r=t.startTime,o=t.isRunning,u=Object(c.useState)(0),s=Object(a.a)(u,2),i=s[0],l=s[1],b=Object(c.useState)(),f=Object(a.a)(b,2),O=f[0],x=f[1];return Object(c.useEffect)((function(){if(o){var e=setInterval((function(){console.log("RunTime: ",i),console.log("StartTime: ",r),console.log("Now: ",Date.now()),r&&l(Date.now()-r)}),1e3);x(e)}else O&&clearInterval(O)}),[o]),Object(j.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"50%",padding:"5px",flexWrap:"wrap"},children:[Object(j.jsx)(A,{property:"Speed",value:n?n+" [km/h]":"--"}),Object(j.jsx)(A,{property:"Time",value:new Date(i).toISOString().substr(11,8)})]})},M=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(I,{}),Object(j.jsx)(L,{}),Object(j.jsx)(J,{})]})},U=function(){return Object(j.jsx)(j.Fragment,{children:"Working on it"})};!function(e){e.ROOT="/",e.NEW="new",e.RUNS="runs"}(r||(r={}));var B=t(2),H=t(13),V=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(H.b,{to:r.NEW,children:"New "}),Object(j.jsx)(H.b,{to:r.RUNS,children:"Runs "})]})},Z=function(e){var n=Object(c.useContext)(d).runner;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("h2",{style:{color:"#eee",fontFamily:"Open Sans Condensed, sans-serif",fontSize:"48px",fontWeight:"bold",lineHeight:"48px",padding:"0 5px",textAlign:"center",textTransform:"uppercase",minWidth:"200px"},children:["Moin ",n.runnerName]}),Object(j.jsx)(V,{})]})};var q=function(){var e=Object(c.useContext)(d).runner;return Object(j.jsx)(j.Fragment,{children:""===(null===e||void 0===e?void 0:e.runnerName)?Object(j.jsx)(m,{}):Object(j.jsxs)("div",{style:{width:"80%",height:"100%",margin:"auto"},children:[Object(j.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:" 1% 0 1% 0",flexWrap:"wrap",margin:"20px 0 20px 0"},children:Object(j.jsx)(Z,{})}),Object(j.jsxs)(B.c,{children:[Object(j.jsx)(B.a,{path:r.NEW,element:Object(j.jsx)(M,{})}),Object(j.jsx)(B.a,{path:r.RUNS,element:Object(j.jsx)(U,{})})]})]})})},G=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,44)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,o=n.getLCP,u=n.getTTFB;t(e),r(e),c(e),o(e),u(e)}))};s.a.render(Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(b,{children:Object(j.jsx)(E,{children:Object(j.jsx)(H.a,{children:Object(j.jsx)(q,{})})})})}),document.getElementById("root")),G()}},[[35,1,2]]]);
//# sourceMappingURL=main.c6ae2d58.chunk.js.map