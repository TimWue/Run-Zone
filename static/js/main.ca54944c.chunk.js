(this["webpackJsonprun-zone-ts"]=this["webpackJsonprun-zone-ts"]||[]).push([[0],{26:function(e,n,t){},27:function(e,n,t){},31:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),o=t(12),u=t.n(o),s=(t(26),t(27),t(7)),a=t.n(s),i=t(16),l=function(e,n){return{getRuns:function(t){return Object(i.a)(a.a.mark((function r(){var c,o;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=[],r.next=3,e.getTracks(t);case 3:return o=r.sent,r.next=6,Promise.all(o.map(function(){var e=Object(i.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getRun(t);case 2:(r=e.sent)&&c.push(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 6:return r.abrupt("return",c);case 7:case"end":return r.stop()}}),r)})))()},getRunner:function(n){return Object(i.a)(a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRunner(n);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))()}}},j=t(2),d=t(36),f=t(38),b=t(9),O=t(6),p=t(1),x=Object(r.createContext)({runnerPosition:void 0,runnerSpeed:null,runner:{runnerName:"",runnerRunIds:[]},runs:[],setRunner:function(e){},setRuns:function(e){},addRun:function(e){},setRunnerPosition:function(e){}}),g=function(e){var n=e.children,t=Object(r.useState)([]),c=Object(j.a)(t,2),o=c[0],u=c[1],s=Object(r.useState)(),a=Object(j.a)(s,2),i=a[0],l=a[1],d=Object(r.useState)(null),f=Object(j.a)(d,2),g=f[0],h=f[1],v=Object(r.useState)({runnerName:"",runnerRunIds:[]}),m=Object(j.a)(v,2),R=m[0],S=m[1],w={enableHighAccuracy:!0},C=function(e){console.warn("ERROR(".concat(e.code,"): ").concat(e.message))},k=function(e){l(new O.LatLng(e.coords.latitude,e.coords.longitude)),e.coords.speed&&h((3.6*e.coords.speed).toFixed(1))};return Object(r.useEffect)((function(){navigator.geolocation.watchPosition(k,C,w)}),[]),Object(p.jsx)(x.Provider,{value:{runner:R,setRunner:S,runs:o,setRuns:u,runnerPosition:i,setRunnerPosition:l,addRun:function(e){u((function(n){return[].concat(Object(b.a)(n),[e])}))},runnerSpeed:g},children:n})},h=t(33),v=t(18),m=function(e){var n=e.runs,t={track2Polygon:function(e){return e.map((function(e){return[e.latitude,e.longitude]}))},calcArea:function(e){var n=e.map((function(e){return[e.latitude,e.longitude]})),t=Object(v.polygon)([n]);return Object(v.area)(t)/1e6}};return Object(p.jsx)(p.Fragment,{children:n.map((function(e,n){return Object(p.jsx)(h.a,{positions:t.track2Polygon(e.track.trackPoints)})}))})},R=t(34),S=t(35),w=function(){var e=Object(r.useContext)(x).runnerPosition,n=Object(R.a)();return Object(r.useEffect)((function(){e&&n.setView(e)}),[e]),Object(p.jsx)(p.Fragment,{children:e&&Object(p.jsx)(S.a,{position:e})})},C=function(e){var n=e.setShowRuns;return Object(p.jsx)("div",{className:"leaflet-top leaflet-right",children:Object(p.jsx)("div",{className:"leaflet-control",children:Object(p.jsx)("button",{onClick:function(){return n((function(e){return!e}))},children:"Show Runs"})})})},k=function(e){var n=e.runnersRunController,t=Object(r.useContext)(x),c=t.runner,o=t.runs,u=t.setRuns,s=Object(r.useState)(!1),a=Object(j.a)(s,2),i=a[0],l=a[1];return Object(r.useEffect)((function(){n.getRunsOfRunner(c.runnerName).then((function(e){u(e)}))}),[c]),Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(d.a,{className:"basicMap",center:[0,0],zoom:20,scrollWheelZoom:!1,style:{width:"100%",height:"400px",borderRadius:"8px"},children:[Object(p.jsx)(f.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),i&&Object(p.jsx)(m,{runs:o}),Object(p.jsx)(w,{}),Object(p.jsx)(C,{setShowRuns:l})]})})},y=[{runnerName:"Tim",runnerRunIds:[]},{runnerName:"Leonie",runnerRunIds:[3]}],P=function(){return{getTracks:function(e){var n=[];for(var t in y)y[t].runnerName===e&&(n=y[t].runnerRunIds);return Promise.resolve(n)},getRunner:function(e){return Promise.resolve(y.find((function(n){return n.runnerName===e})))}}},T=function(){var e=localStorage.getItem("runs"),n=e?JSON.parse(e):void 0;return{getRun:function(e){var t=void 0;for(var r in n)n[r].runId===e&&(t=n[r]);return Promise.resolve(t)},saveRuns:function(e){localStorage.setItem("runs",JSON.stringify(e))}}},N=function(e){var n=P(),t=T(),c=function(e){return{getRunsOfRunner:Object(r.useCallback)((function(n){return e.getRuns(n)}),[e])}}(l(n,t));return Object(p.jsx)(k,{runnersRunController:c})},I=Object(r.createContext)({}),F=function(e){var n=e.children,t=Object(r.useState)(),c=Object(j.a)(t,2),o=c[0],u=c[1],s=Object(r.useState)([]),a=Object(j.a)(s,2),i=a[0],l=a[1],d=Object(r.useState)(),f=Object(j.a)(d,2),O=f[0],x=f[1],g=Object(r.useState)(!1),h=Object(j.a)(g,2),v=h[0],m=h[1];return Object(p.jsx)(I.Provider,{value:{startTime:o,isRunning:v,setIsRunning:m,run:O,startRun:function(){console.log("Start Run"),u(Date.now()),m(!0)},stopRun:function(){console.log("Stop Run"),x({track:{trackPoints:i},startTime:o||Date.now(),endTime:Date.now()}),m(!1)},addTrackPoint:function(e){console.log("Add TrackPoint: ",e),l((function(n){return[].concat(Object(b.a)(n),[e])}))},resetRun:function(){x(void 0),u(void 0),l([])}},children:n})},D=function(e){var n=e.property,t=e.value;return Object(p.jsxs)("div",{style:{width:"20%",minWidth:"200px",backgroundColor:"#555",borderRadius:"10px",padding:"10px",margin:"10px"},children:[Object(p.jsx)("div",{style:{fontFamily:"Open Sans Condensed, sans-serif",fontSize:"36px",fontWeight:"bold",textTransform:"uppercase",color:"#eee"},children:n}),Object(p.jsx)("div",{style:{fontFamily:"Open Sans Condensed, sans-serif",fontSize:"24px",fontWeight:"bold",textTransform:"uppercase",color:"#eee"},children:t})]})},z=function(e){var n=Object(r.useContext)(x).runnerSpeed,t=Object(r.useContext)(I),c=t.startTime,o=t.isRunning,u=Object(r.useState)(0),s=Object(j.a)(u,2),a=s[0],i=s[1],l=Object(r.useState)(),d=Object(j.a)(l,2),f=d[0],b=d[1];return Object(r.useEffect)((function(){if(o){var e=setInterval((function(){console.log("RunTime: ",a),console.log("StartTime: ",c),console.log("Now: ",Date.now()),c&&i(Date.now()-c)}),1e3);b(e)}else f&&clearInterval(f)}),[o]),Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"50%",padding:"20px",flexWrap:"wrap"},children:[Object(p.jsx)(D,{property:"Speed",value:n?n+" [km/h]":"--"}),Object(p.jsx)(D,{property:"Time",value:new Date(a).toISOString().substr(11,8)})]})},E=function(e){var n=Object(r.useState)(""),t=Object(j.a)(n,2),c=t[0],o=t[1],u=P(),s=T(),a=l(u,s),i=Object(r.useContext)(x).setRunner;return Object(p.jsxs)("div",{children:[Object(p.jsx)("input",{type:"text",onChange:function(e){o(e.target.value)},value:c,placeholder:"Enter your Name:"}),Object(p.jsx)("button",{onClick:function(){console.log("Login "+c),a.getRunner(c).then((function(e){e&&i(e)}))},children:"Login"})]})},W=t(37),L=t(39),A=function(){var e=Object(r.useContext)(x).runnerPosition,n=Object(r.useContext)(I),t=n.addTrackPoint,c=n.startRun,o=n.stopRun,u=n.run,s=n.resetRun,a=n.isRunning,i=Object(r.useContext)(x),l=i.addRun,j=i.runs,d=T();Object(r.useEffect)((function(){a&&f()}),[e]);var f=function(){e&&t({latitude:e.lat,longitude:e.lng,time:Date.now()})};return Object(p.jsxs)(W.a,{size:"lg",children:[Object(p.jsx)(L.a,{onClick:function(){c()},disabled:a,variant:"dark",children:"Start"}),Object(p.jsx)(L.a,{onClick:function(){o()},disabled:!a,variant:"dark",children:"Stop"}),Object(p.jsx)(L.a,{onClick:function(){console.log("Save run"),d.saveRuns([].concat(Object(b.a)(j),[u])),l(u)},disabled:a,variant:"dark",children:"Save"}),Object(p.jsx)(L.a,{onClick:function(){console.log("Reset run"),s()},disabled:a,variant:"dark",children:"Reset"})]})},J=function(e){var n=Object(r.useContext)(x).runner;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("h2",{style:{color:"#eee",fontFamily:"Open Sans Condensed, sans-serif",fontSize:"48px",fontWeight:"bold",lineHeight:"48px",padding:"0 5px",textAlign:"center",textTransform:"uppercase",minWidth:"200px"},children:["Moin ",n.runnerName]}),Object(p.jsx)(A,{})]})};var M=function(){var e=Object(r.useContext)(x).runner;return Object(p.jsx)(p.Fragment,{children:""===(null===e||void 0===e?void 0:e.runnerName)?Object(p.jsx)(E,{}):Object(p.jsxs)("div",{style:{width:"80%",height:"100%",margin:"auto"},children:[Object(p.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:" 1% 0 1% 0",flexWrap:"wrap",margin:"20px 0 20px 0"},children:Object(p.jsx)(J,{})}),Object(p.jsx)(N,{}),Object(p.jsx)(z,{})]})})},B=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,40)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,o=n.getLCP,u=n.getTTFB;t(e),r(e),c(e),o(e),u(e)}))};u.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(g,{children:Object(p.jsx)(F,{children:Object(p.jsx)(M,{})})})}),document.getElementById("root")),B()}},[[31,1,2]]]);
//# sourceMappingURL=main.ca54944c.chunk.js.map