(this["webpackJsonprun-zone-ts"]=this["webpackJsonprun-zone-ts"]||[]).push([[0],{23:function(e,n,t){},24:function(e,n,t){},28:function(e,n,t){"use strict";t.r(n);var r=t(0),u=t.n(r),c=t(12),o=t.n(c),s=(t(23),t(24),t(7)),a=t.n(s),i=t(14),j=function(e,n){return{getRuns:function(t){return Object(i.a)(a.a.mark((function r(){var u,c;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=[],r.next=3,e.getTracks(t);case 3:return c=r.sent,r.next=6,Promise.all(c.map(function(){var e=Object(i.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getRun(t);case 2:(r=e.sent)&&u.push(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 6:return r.abrupt("return",u);case 7:case"end":return r.stop()}}),r)})))()},getRunner:function(n){return Object(i.a)(a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRunner(n);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))()}}},b=t(2),l=t(32),d=t(33),f=t(9),O=t(1),x=Object(r.createContext)({runnerPosition:void 0,runner:{runnerName:"",runnerRunIds:[]},runs:[],setRunner:function(e){},setRuns:function(e){},addRun:function(e){},setRunnerPosition:function(e){}}),g=function(e){var n=e.children,t=Object(r.useState)(),u=Object(b.a)(t,2),c=u[0],o=u[1],s=Object(r.useState)({runnerName:"",runnerRunIds:[]}),a=Object(b.a)(s,2),i=a[0],j=a[1],l=Object(r.useState)([]),d=Object(b.a)(l,2),g=d[0],v=d[1];return Object(O.jsx)(x.Provider,{value:{runner:i,setRunner:j,runs:g,setRuns:v,runnerPosition:c,setRunnerPosition:o,addRun:function(e){v((function(n){return[].concat(Object(f.a)(n),[e])}))}},children:n})},v=t(29),p=t(16),h=function(){return{track2Polygon:function(e){return e.map((function(e){return[e.latitude,e.longitude]}))},calcArea:function(e){var n=e.map((function(e){return[e.latitude,e.longitude]})),t=Object(p.polygon)([n]);return Object(p.area)(t)/1e6}}},m=function(e){var n=e.runs,t=h();return Object(O.jsx)(O.Fragment,{children:n.map((function(e,n){return Object(O.jsx)(v.a,{positions:t.track2Polygon(e.track.trackPoints)})}))})},R=t(30),S=t(31),k=t(4),C=function(){var e=Object(r.useContext)(x),n=e.runnerPosition,t=e.setRunnerPosition,u=Object(R.a)();return Object(r.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){t(new k.LatLng(e.coords.latitude,e.coords.longitude))}))}),[]),Object(r.useEffect)((function(){n&&u.setView(n)}),[n]),Object(O.jsx)(O.Fragment,{children:n&&Object(O.jsx)(S.a,{position:n})})},P=function(e){var n=e.runnersRunController,t=Object(r.useContext)(x),u=t.runner,c=t.runs,o=t.setRuns,s=Object(r.useState)(!1),a=Object(b.a)(s,2),i=a[0],j=a[1];return Object(r.useEffect)((function(){n.getRunsOfRunner(u.runnerName).then((function(e){o(e)}))}),[u]),Object(O.jsxs)("div",{style:{width:"50%",height:"100%"},children:[Object(O.jsxs)(l.a,{className:"basicMap",center:[0,0],zoom:13,scrollWheelZoom:!1,children:[Object(O.jsx)(d.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),i&&Object(O.jsx)(m,{runs:c}),Object(O.jsx)(C,{})]}),Object(O.jsx)("button",{onClick:function(){return j(!i)},children:"Show Runs"})]})},w=[{runnerName:"Tim",runnerRunIds:[]},{runnerName:"Leonie",runnerRunIds:[3]}],N=function(){return{getTracks:function(e){var n=[];for(var t in w)w[t].runnerName===e&&(n=w[t].runnerRunIds);return Promise.resolve(n)},getRunner:function(e){return Promise.resolve(w.find((function(n){return n.runnerName===e})))}}},I=function(){var e=localStorage.getItem("runs"),n=e?JSON.parse(e):void 0;return{getRun:function(e){var t=void 0;for(var r in n)n[r].runId===e&&(t=n[r]);return Promise.resolve(t)},saveRuns:function(e){localStorage.setItem("runs",JSON.stringify(e))}}},y=function(e){var n=N(),t=I(),u=function(e){return{getRunsOfRunner:Object(r.useCallback)((function(n){return e.getRuns(n)}),[e])}}(j(n,t));return Object(O.jsx)(P,{runnersRunController:u})},F=Object(r.createContext)({}),T=function(e){var n=e.children,t=Object(r.useState)(),u=Object(b.a)(t,2),c=u[0],o=u[1],s=Object(r.useState)([]),a=Object(b.a)(s,2),i=a[0],j=a[1],l=Object(r.useState)(),d=Object(b.a)(l,2),x=d[0],g=d[1],v=Object(r.useState)(null),p=Object(b.a)(v,2),h=p[0],m=p[1];return Object(O.jsx)(F.Provider,{value:{speed:h,setSpeed:m,run:x,startRun:function(){console.log("Start Run"),o(Date.now())},stopRun:function(){console.log("Stop Run"),g({track:{trackPoints:i},startTime:c||Date.now(),endTime:Date.now()})},addTrackPoint:function(e){console.log("Add TrackPoint: ",e),j((function(n){return[].concat(Object(f.a)(n),[e])}))}},children:n})},L=function(e){var n=Object(r.useState)(0),t=Object(b.a)(n,2),u=t[0],c=t[1],o=Object(r.useContext)(x).runs,s=Object(r.useContext)(F).speed,a=h();return Object(r.useEffect)((function(){c(o.map((function(e){return a.calcArea(e.track.trackPoints)})).reduce((function(e,n){return e+n}),0))}),[o]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{children:["Area: ",u.toFixed(2)," [km^2]"]}),s&&Object(O.jsxs)("div",{children:["Speed: ",s]})]})},E=function(e){var n=Object(r.useState)(""),t=Object(b.a)(n,2),u=t[0],c=t[1],o=N(),s=I(),a=j(o,s),i=Object(r.useContext)(x).setRunner;return Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"text",onChange:function(e){c(e.target.value)},value:u,placeholder:"Enter your Name:"}),Object(O.jsx)("button",{onClick:function(){console.log("Login "+u),a.getRunner(u).then((function(e){e&&i(e)}))},children:"Login"})]})},D=function(e){var n=Object(r.useContext)(x).runner;return Object(O.jsxs)("div",{children:["Hello ",n.runnerName]})},z=function(){var e=Object(r.useContext)(F),n=e.addTrackPoint,t=e.startRun,u=e.stopRun,c=e.run,o=e.setSpeed,s=Object(r.useContext)(x),a=s.addRun,i=s.runs,j=Object(r.useState)(),l=Object(b.a)(j,2),d=l[0],g=l[1],v=Object(r.useState)(!1),p=Object(b.a)(v,2),h=p[0],m=p[1],R=I();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("button",{onClick:function(){t();var e=setInterval((function(){navigator.geolocation.getCurrentPosition((function(e){o(e.coords.speed),n({latitude:e.coords.latitude,longitude:e.coords.longitude,time:Date.now()})}))}),2e3);g(e),m(!0)},disabled:h,children:"Start"}),Object(O.jsx)("button",{onClick:function(){u(),clearInterval(d),m(!1)},disabled:!h,children:"Stop"}),Object(O.jsx)("button",{onClick:function(){R.saveRuns([].concat(Object(f.a)(i),[c])),a(c)},children:"Save"})]})};var A=function(){var e=Object(r.useContext)(x).runner;return Object(O.jsx)(O.Fragment,{children:""===(null===e||void 0===e?void 0:e.runnerName)?Object(O.jsx)(E,{}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(D,{}),Object(O.jsx)(y,{}),Object(O.jsx)(L,{}),Object(O.jsx)(z,{})]})})},J=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,34)).then((function(n){var t=n.getCLS,r=n.getFID,u=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),r(e),u(e),c(e),o(e)}))};o.a.render(Object(O.jsx)(u.a.StrictMode,{children:Object(O.jsx)(g,{children:Object(O.jsx)(T,{children:Object(O.jsx)(A,{})})})}),document.getElementById("root")),J()}},[[28,1,2]]]);
//# sourceMappingURL=main.d5f9abd7.chunk.js.map